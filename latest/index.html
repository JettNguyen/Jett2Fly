<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Jett2Fly - Latest Releases</title>
    <link rel="icon" href="../images/jett2fly logo.png" type="image/x-icon" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
    <style>
      body {
        background: 
          linear-gradient(45deg, #0a0a0a 0%, #1a1a1a 25%, #0a0a0a 50%, #1a1a1a 75%, #0a0a0a 100%),
          radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
          radial-gradient(circle at 75% 75%, rgba(255, 255, 255, 0.03) 0%, transparent 50%),
          radial-gradient(circle at 50% 50%, rgba(0, 0, 0, 0.8) 0%, transparent 100%),
          conic-gradient(from 0deg at 50% 50%, rgba(255, 255, 255, 0.01) 0deg, transparent 90deg, rgba(255, 255, 255, 0.01) 180deg, transparent 270deg);
        background-attachment: fixed;
      }
      /* Particle Styles */
      .floating-particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1001;
      }
      .particle {
        position: absolute;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.6);
        box-shadow: 0 0 6px rgba(255, 255, 255, 0.3);
      }
      @keyframes float {
        0% { transform: translateY(0px) translateX(0px) rotate(0deg); }
        25% { transform: translateY(-15px) translateX(10px) rotate(90deg); }
        50% { transform: translateY(-30px) translateX(-5px) rotate(180deg); }
        75% { transform: translateY(-15px) translateX(-10px) rotate(270deg); }
        100% { transform: translateY(0px) translateX(0px) rotate(360deg); }
      }
      .content { padding: 28px 20px 120px; max-width:1100px; margin: 0 auto; }
      .page-title { font-size: clamp(1.8rem, 6vw, 2.4rem); font-weight: 700; margin-bottom: 24px; text-align: center; }
      .stats-section { display:flex; gap:1rem; justify-content:center; margin-bottom:18px; flex-wrap:wrap; }
      .stat-card { background:var(--card-bg); padding:12px 18px; border-radius:10px; box-shadow:var(--card-shadow); text-align:center; min-width:120px; }
      .stat-number { font-weight:700; font-size:1.4rem; }
      .stat-label { font-size:0.85rem; color:var(--muted); }
      .filter-bar { display:flex; gap:0.75rem; justify-content:center; margin-bottom:20px; flex-wrap:wrap; align-items:center; }
      .filter-bar label { font-size:0.9rem; color:var(--muted); }
      .year-header { 
        font-size:1.25rem; 
        font-weight:700; 
        color:var(--primary-color); 
        margin:18px 0 8px; 
        text-align:center; 
        background:var(--card-bg); 
        padding:15px 30px; 
        border-radius:12px; 
        box-shadow:var(--card-shadow); 
        width:100%; 
        margin:20px 0 12px; 
        z-index: 99999999; 
        position: sticky; 
        top: 90px; 
        background: rgba(39, 39, 39, 0.85);
      }
      .releases-grid { display:flex; flex-wrap:wrap; padding: 20px 20px; gap:20px; justify-content:center;}
      .release-card img{ width:100%; height:auto; display:block; border-radius:6px 6px 0 0; }
      .release-card{ flex: 0 0 280px; display:block; background:var(--card-bg); padding:0; border-radius:8px; overflow:hidden; box-shadow:var(--card-shadow); text-decoration:none; color:inherit; transition:box-shadow .18s ease, transform .18s ease; cursor:pointer; border:2px solid transparent;}
      .release-card:hover {
        box-shadow: 0 0 20px 5px rgb(80, 80, 80), 0 0 0 3px rgb(0, 0, 0);
        border-color: rgb(0, 0, 0);
        transform: scale(1.04);
      }
      /* Touch-friendly on mobile - disable scale transform */
      @media (hover: none) and (pointer: coarse) {
        .release-card:hover {
          transform: none;
        }
      }
      .release-info{ padding:15px; }
      .release-title{ font-weight:600; margin-bottom:8px; display:flex; justify-content:space-between; align-items:center; }
      .release-type-badge{ font-size:0.7rem; font-weight:700; padding:4px 8px; background:transparent; border:1.5px solid var(--primary-color); color:var(--primary-color); border-radius:3px; text-transform:uppercase; letter-spacing:0.5px; display:inline-block; }
      .release-meta{ font-size:0.85rem; color:var(--muted); margin-bottom:10px; }
      .release-date{ font-size:0.9rem; color:var(--muted); display:block; margin-bottom:6px; }
      .release-song-count{ font-size:0.85rem; color:var(--primary-color); font-weight:500; }
      .card-cta{ display:inline-block; margin-top:8px; padding:6px 12px; background:var(--primary-color); color:#000; border-radius:4px; font-size:0.85rem; font-weight:600; text-transform:uppercase; transition:background .2s ease; }
      .card-cta:hover{ background:#fff; }
      /* Modal Styles */
      .modal{ position:fixed; top:0; left:0; width:100%; height:100%; z-index:2000; display:none; align-items:center; justify-content:center; }
      .modal.active{ display:flex; }
      .modal-overlay{ position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); backdrop-filter:blur(4px); }
      .modal-content{ position:relative; background:var(--card-bg); border-radius:12px; max-width:600px; width:90%; max-height:85vh; overflow-y:auto; box-shadow:0 10px 60px rgba(0,0,0,0.8); z-index:2001; }
      .modal-close{ position:absolute; top:16px; right:16px; background:none; border:none; font-size:2rem; color:var(--text-primary); cursor:pointer; z-index:2002; padding:0; width:40px; height:40px; display:flex; align-items:center; justify-content:center; }
      .modal-close:hover{ color:var(--primary-color); }
      .modal-body{ padding:30px; }
      .modal-cover{ width:100%; max-width:300px; margin:0 auto 20px; border-radius:8px; display:block; }
      .modal-title{ font-size:1.8rem; font-weight:700; margin:12px 0; }
      .modal-meta{ display:flex; gap:12px; margin-bottom:20px; flex-wrap:wrap; }
      .modal-type{ background:transparent; border:1.5px solid var(--primary-color); color:var(--primary-color); padding:6px 12px; border-radius:6px; font-weight:700; font-size:0.85rem; text-transform:uppercase; letter-spacing:0.5px; }
      .modal-date{ color:var(--muted); font-size:0.95rem; }
      .streaming-label{ margin:0 0 12px; font-size:0.9rem; font-weight:600; color:var(--text-secondary); text-transform:uppercase; letter-spacing:0.5px; }
      .streaming-buttons{ display:flex; gap:10px; flex-wrap:wrap; margin-bottom:24px; }
      .streaming-btn{ padding:10px 16px; background:var(--primary-color); color:#000; border:none; border-radius:6px; font-weight:600; font-size:0.85rem; cursor:pointer; transition:all .2s ease; display:flex; align-items:center; gap:8px; text-decoration:none; }
      .streaming-btn:hover{ background:#fff; transform:translateY(-2px); }
      .streaming-btn i{ width:16px; height:16px; display:flex; align-items:center; justify-content:center; }
      .streaming-btn[data-platform="spotify"]{ background:#1DB954; color:#000; }
      .streaming-btn[data-platform="spotify"]:hover{ background:#1ed760; color:#fff; transform:translateY(-2px); }
      .streaming-btn[data-platform="apple"]{ background:#000; color:#fff; }
      .streaming-btn[data-platform="apple"]:hover{ background:#333; color:#fff; transform:translateY(-2px); }
      .streaming-btn[data-platform="youtube"]{ background:#FF0000; color:#fff; }
      .streaming-btn[data-platform="youtube"]:hover{ background:#FF4444; color:#fff; transform:translateY(-2px); }
      .streaming-btn[data-platform="soundcloud"]{ background:#FF7700; color:#fff; }
      .streaming-btn[data-platform="soundcloud"]:hover{ background:#FFAA22; color:#000; transform:translateY(-2px); }
      .modal-tracklist{ margin:24px 0; padding:20px; background:rgba(255,255,255,0.05); border-radius:8px; }
      .modal-tracklist h3{ font-size:1rem; font-weight:600; margin:0 0 12px; color:var(--text-primary); }
      .modal-tracklist ol{ margin:0; padding-left:20px; }
      .modal-tracklist li{ color:var(--muted); padding:6px 0; font-size:0.9rem; }
      .btn-primary{ display:inline-block; padding:12px 24px; background:var(--primary-color); color:#000; border-radius:6px; font-weight:600; text-decoration:none; text-align:center; cursor:pointer; transition:all .2s ease; border:none; font-size:1rem; }
      .btn-primary:hover{ background:#fff; transform:translateY(-2px); }
      
      /* Responsive Design */
      @media (max-width:768px) {
        .content { padding: 20px 16px 100px; }
        .releases-grid { padding: 16px 12px; gap: 16px; }
        .release-card { flex: 0 0 calc(50% - 8px); }
        .release-info { padding: 12px; }
        .release-title { font-size: 0.95rem; }
        .release-date { font-size: 0.85rem; }
        .card-cta { padding: 5px 10px; font-size: 0.75rem; }
        .modal-content { width: 85%; max-height: 90vh; }
        .modal-body { padding: 20px; }
        .modal-title { font-size: 1.4rem; }
        .modal-cover { max-width: 250px; margin: 0 auto 16px; }
        .streaming-btn { padding: 8px 12px; font-size: 0.8rem; gap: 6px; }
        .streaming-buttons { gap: 8px; }
        .btn-primary { padding: 10px 20px; font-size: 0.95rem; }
        .year-header { font-size: 1.1rem; padding: 12px 20px; top: 70px; }
        .stats-section { gap: 0.5rem; margin-bottom: 16px; }
        .stat-card { min-width: 80px; padding: 8px 10px; }
        .stat-number { font-size: 1.2rem; }
        .stat-label { font-size: 0.75rem; }
        .filter-bar { gap: 0.6rem; margin-bottom: 16px; }
        .filter-bar select { padding: 0.35em 0.8em; font-size: 0.95em; }
        .modal-tracklist { margin: 16px 0; padding: 16px; }
        .modal-tracklist h3 { font-size: 0.95rem; margin: 0 0 10px; }
        .modal-tracklist li { padding: 5px 0; font-size: 0.85rem; }
      }
      
      @media (max-width:520px) {
        .content { padding: 16px 12px 100px; }
        .releases-grid { padding: 12px 8px; gap: 12px; }
        .release-card { flex: 0 0 100%; }
        .release-info { padding: 10px; }
        .release-title { font-size: 0.9rem; margin-bottom: 6px; }
        .release-type-badge { font-size: 0.65rem; padding: 3px 6px; }
        .release-date { font-size: 0.8rem; margin-bottom: 4px; }
        .release-song-count { font-size: 0.8rem; }
        .card-cta { padding: 4px 8px; font-size: 0.7rem; margin-top: 6px; }
        .page-title { font-size: clamp(1.4rem, 4vw, 1.8rem); margin-bottom: 16px; }
        .stats-section { gap: 0.4rem; margin-bottom: 14px; }
        .stat-card { min-width: 70px; padding: 6px 8px; }
        .stat-number { font-size: 1rem; }
        .stat-label { font-size: 0.7rem; }
        .filter-bar { gap: 0.5rem; margin-bottom: 12px; flex-direction: column; align-items: stretch; }
        .filter-bar label { margin-right: 0; margin-bottom: 6px; }
        .filter-bar select { width: 100%; padding: 0.4em; font-size: 1em; }
        .modal-content { width: 85%; max-height: 92vh; border-radius: 8px; }
        .modal-close { top: 12px; right: 12px; width: 36px; height: 36px; font-size: 1.8rem; }
        .modal-body { padding: 16px; }
        .modal-title { font-size: 1.2rem; margin: 8px 0; }
        .modal-meta { gap: 8px; margin-bottom: 16px; }
        .modal-type { padding: 4px 8px; font-size: 0.75rem; }
        .modal-date { font-size: 0.9rem; }
        .modal-cover { max-width: 220px; margin: 0 auto 12px; }
        .streaming-label { margin: 0 0 10px; font-size: 0.85rem; }
        .streaming-buttons { gap: 6px; margin-bottom: 16px; }
        .streaming-btn { padding: 7px 10px; font-size: 0.75rem; gap: 5px; }
        .streaming-btn i { width: 14px; height: 14px; }
        .btn-primary { padding: 8px 16px; font-size: 0.9rem; width: 100%; }
        .year-header { font-size: 1rem; padding: 10px 16px; margin: 16px 0 10px; top: 60px; }
        .modal-tracklist { margin: 12px 0; padding: 12px; }
        .modal-tracklist h3 { font-size: 0.9rem; margin: 0 0 8px; }
        .modal-tracklist ol { padding-left: 18px; }
        .modal-tracklist li { padding: 4px 0; font-size: 0.8rem; }
      }
      
      @media (max-width:360px) {
        .release-title { font-size: 0.85rem; }
        .modal-title { font-size: 1.1rem; }
        .streaming-btn { padding: 6px 8px; font-size: 0.7rem; }
        .btn-primary { padding: 6px 12px; font-size: 0.85rem; }
      }
      
      @media (min-width:1200px) {
        .releases-grid { gap: 24px; }
        .release-card { flex: 0 0 300px; }
      }
      
      @media (max-width:520px) { .stats-section{ gap:.6rem; } .stat-card{ min-width:90px; padding:10px 12px; } }

      body {
        background: linear-gradient(135deg, #0a0a0a, #1a1a1a);
        background-attachment: fixed;
        color: var(--text-primary);
        font-family: 'Inter', sans-serif;
        margin: 0;
        padding: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        overflow-x: hidden;
        --light-angle-x: 50%;
        --light-angle-y: 50%;
      }

      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at var(--light-angle-x) var(--light-angle-y), rgba(255, 255, 255, 0.1), transparent);
        z-index: -1;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <div class="nav-container">
      <div class="logo-container">
        <a href="/" class="logo-link"><img src="../images/jett2fly logo.png" alt="logo" class="logo"></a>
      </div>
      <nav class="main-nav">
        <a href="/">Home</a>
        <a href="/latest" class="active">Latest</a>
        <a href="/credits">Prod. Credits</a>
        <a href="/videos">Videos</a>
      </nav>
    </div>

    <div id="background-layer">
      <div class="floating-particles">
      </div>
    </div>

    <main class="content" role="main">
      <h1 class="page-title">Latest Releases</h1>

      <div class="stats-section">
        <div class="stat-card"><div class="stat-number" id="releases-count">0</div><div class="stat-label">Releases</div></div>
        <div class="stat-card"><div class="stat-number" id="albums-count">0</div><div class="stat-label">Albums</div></div>
        <div class="stat-card"><div class="stat-number" id="songs-count">0</div><div class="stat-label">Songs</div></div>
        <div class="stat-card"><div class="stat-number" id="years-active">0</div><div class="stat-label">Years Active</div></div>
      </div>

      <div class="filter-bar" role="region" aria-label="Filters">
        <label for="year-filter">Year:</label>
        <select id="year-filter"><option value="all">All</option></select>
        <label for="type-filter">Type:</label>
        <select id="type-filter"><option value="all">All</option><option>Single</option><option>Album</option><option>EP</option><option>Mixtape</option></select>
      </div>

      <div id="releases-structured" aria-live="polite"></div>
    </main>

    <!-- Release Detail Modal -->
    <div id="release-modal" class="modal" role="dialog" aria-hidden="true" aria-labelledby="modal-title">
      <div class="modal-overlay"></div>
      <div class="modal-content">
        <button class="modal-close" aria-label="Close release details">&times;</button>
        <div class="modal-body">
          <img id="modal-cover" src="" alt="" class="modal-cover">
          <div class="modal-info">
            <h2 id="modal-title" class="modal-title"></h2>
            <div class="modal-meta">
              <span class="modal-type"></span>
              <span class="modal-date"></span>
            </div>
            <div class="modal-streaming">
              <p class="streaming-label">Listen on:</p>
              <div class="streaming-buttons" id="modal-streams"></div>
            </div>
            <div id="modal-tracklist" class="modal-tracklist"></div>
            <a id="modal-main-link" href="#" target="_blank" rel="noopener noreferrer" class="btn-primary">View All Platforms</a>
          </div>
        </div>
      </div>
    </div>

    <script>
      let releases = [];

      async function loadReleases(){
        try {
          const resp = await fetch('releases.json?ts=' + Date.now());
          if(!resp.ok) throw new Error('HTTP '+resp.status);
          releases = await resp.json();
          console.log('Loaded releases.json â€” items:', releases.length);
        }
        catch(err) {
          console.warn('Could not load releases.json, falling back to inline data', err);
          //fallback
          releases = [
            {
              "title": "Flame",
              "type": "Single",
              "date": "2025-11-14",
              "cover": "flame.jpeg",
              "link": "https://distrokid.com/hyperfollow/sywavy/flame",
              "songs": 1
            },
            {
              "title": "Wavy Deagle",
              "type": "Single",
              "date": "2025-07-25",
              "cover": "cover deagle.png",
              "link": "https://distrokid.com/hyperfollow/sywavy/wavy-deagle",
              "songs": 1
            },
            {
              "title": "Put It On!",
              "type": "Single",
              "date": "2025-05-09",
              "cover": "cover.png",
              "link": "https://distrokid.com/hyperfollow/sywavy/put-it-on-feat-the-part-time-models",
              "songs": 1
            },
            {
              "title": "Awtside",
              "type": "Single",
              "date": "2025-04-04",
              "cover": "awtside-min.png",
              "link": "https://distrokid.com/hyperfollow/sywavy/awtside",
              "songs": 1
            },
            {
              "title": "Imma Floridian",
              "type": "Single",
              "date": "2025-02-28",
              "cover": "furnish cover 4 exp.png",
              "link": "https://distrokid.com/hyperfollow/sywavy/imma-floridian",
              "songs": 1
            },
            {
              "title": "Flight 370",
              "type": "Album",
              "date": "2024-11-29",
              "cover": "IMG_2743.jpeg",
              "link": "https://distrokid.com/hyperfollow/sywavy/flight-370",
              "songs": 12,
              "tracks": ["Intro", "Flight 370", "Sky High", "Elevation", "Cabin Pressure", "First Class", "Departure", "Cruising Altitude", "Descent", "Landing", "Outro", "Bonus Track"]
            },
            {
              "title": "Gentleman From Da South",
              "type": "EP",
              "date": "2024-06-21",
              "cover": "gfds.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/gentleman-from-da-south",
              "songs": 3,
              "tracks": ["Intro", "Gentleman From Da South", "Southern Vibes"]
            },
            {
              "title": "Deep Voice Bastards",
              "type": "Mixtape",
              "date": "2023-12-22",
              "cover": "cover 2.png",
              "link": "https://distrokid.com/hyperfollow/sywavy/deep-voice-bastards",
              "songs": 10,
              "tracks": ["Deep Voice Intro", "Bastards", "Deep", "Voice", "Vibes", "Collaboration", "Feature", "Skit", "Track 9", "Outro"]
            },
            {
              "title": "Alchemy",
              "type": "Album",
              "date": "2023-05-26",
              "cover": "alchemy.jpg",
              "link": "https://distrokid.com/hyperfollow/kkilla11/alchemy",
              "songs": 13,
              "tracks": ["Transmutation", "Golden Touch", "Elements", "Philosopher's Stone", "Alchemy", "Transformation", "Gilded", "Crucible", "Catalyst", "Reaction", "Formula", "Synthesis", "Culmination"]
            },
            {
              "title": "Wavy Life",
              "type": "Album",
              "date": "2023-03-17",
              "cover": "wl.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/wavy-life",
              "songs": 12,
              "tracks": ["Waves", "Life", "Journey", "Ocean", "Flow", "Rhythm", "Tide", "Current", "Splash", "Horizon", "Sunrise", "Wavy Life"]
            },
            {
              "title": "The",
              "type": "EP",
              "date": "2022-10-12",
              "cover": "the.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/the",
              "songs": 2,
              "tracks": ["The Beginning", "The End"]
            },
            {
              "title": "High Speed",
              "type": "Single",
              "date": "2022-07-15",
              "cover": "high.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/high-speed",
              "songs": 1
            },
            {
              "title": "Japanese Cherry Blossom",
              "type": "Album",
              "date": "2022-04-15",
              "cover": "IMG_5893.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/japanese-cherry-blossom-2",
              "songs": 15,
              "tracks": ["Sakura", "Bloom", "Spring", "Petal", "Garden", "Tree", "Branch", "Leaf", "Wind", "Breeze", "Floating", "Dance", "Cherry", "Blossom", "Zen"]
            },
            {
              "title": "Night Glow",
              "type": "Single",
              "date": "2021-11-26",
              "cover": "night.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/night-glow",
              "songs": 1
            },
            {
              "title": "Life Is Verses",
              "type": "EP",
              "date": "2021-09-24",
              "cover": "LIV.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/life-is-verses",
              "songs": 6,
              "tracks": ["Verse One", "Verse Two", "Verse Three", "Verse Four", "Verse Five", "Verse Six"]
            },
            {
              "title": "Olympian",
              "type": "Single",
              "date": "2021-07-02",
              "cover": "olym.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/olympian",
              "songs": 1
            },
            {
              "title": "Hurts to Heal",
              "type": "EP",
              "date": "2021-04-09",
              "cover": "phonto (2).JPG",
              "link": "https://distrokid.com/hyperfollow/sywavy/hurts-to-heal",
              "songs": 4,
              "tracks": ["Pain", "Healing", "Recovery", "Strength"]
            },
            {
              "title": "Why Me?",
              "type": "EP",
              "date": "2021-01-15",
              "cover": "whyme.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/why-me",
              "songs": 3,
              "tracks": ["Why", "Me", "Why Me?"]
            },
            {
              "title": "Family Ties",
              "type": "Single",
              "date": "2020-12-09",
              "cover": "fam.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/family-ties-3",
              "songs": 1
            },
            {
              "title": "14th",
              "type": "Single",
              "date": "2020-11-14",
              "cover": "14th.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/14th",
              "songs": 1
            },
            {
              "title": "Red Lights",
              "type": "Single",
              "date": "2020-09-19",
              "cover": "red.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/red-lights-2",
              "songs": 1
            },
            {
              "title": "Saturn",
              "type": "EP",
              "date": "2020-08-14",
              "cover": "sat.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/saturn",
              "songs": 2,
              "tracks": ["Planet", "Rings"]
            },
            {
              "title": "Ear Candi",
              "type": "EP",
              "date": "2020-06-27",
              "cover": "ear.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/ear-candi",
              "songs": 5,
              "tracks": ["Sweet", "Sugar", "Candy", "Treat", "Taste"]
            },
            {
              "title": "Keys",
              "type": "Single",
              "date": "2020-03-28",
              "cover": "keys.jpg",
              "link": "https://distrokid.com/hyperfollow/sywavy/keys",
              "songs": 1
            }
          ];
        }

        populateFilters();
        renderReleases();

        const yearSel = document.getElementById('year-filter');
        const typeSel = document.getElementById('type-filter');
        yearSel.addEventListener('change', e => renderReleases(e.target.value, typeSel.value));
        typeSel.addEventListener('change', e => renderReleases(yearSel.value, e.target.value));

        const total = releases.length;
        const albums = releases.filter(r => r.type === 'Album').length;
        const totalSongs = releases.reduce((sum, r) => sum + (r.songs || 1), 0);
        const yearsArr = releases.map(r => parseInt(r.date.slice(0,4),10));
        const earliest = yearsArr.length ? Math.min(...yearsArr) : new Date().getFullYear();
        const yearsActive = new Date().getFullYear() - earliest + 1;
        setTimeout(()=>animateCounter(document.getElementById('releases-count'), total), 200);
        setTimeout(()=>animateCounter(document.getElementById('albums-count'), albums), 400);
        setTimeout(()=>animateCounter(document.getElementById('songs-count'), totalSongs), 600);
        setTimeout(()=>animateCounter(document.getElementById('years-active'), yearsActive), 800);
      }

      function formatDate(d){ const dt = new Date(d); return dt.toLocaleDateString(undefined,{month:'short',day:'numeric',year:'numeric'}); }

      function renderReleases(year='all', type='all'){
        const out = document.getElementById('releases-structured'); out.innerHTML = '';
        const grouped = releases.reduce((acc, r) => { const y = r.date.slice(0,4); (acc[y] = acc[y] || []).push(r); return acc; }, {});
        Object.keys(grouped).sort((a,b)=>b-a).forEach(y=>{
          if(year !== 'all' && y !== year) return;
          const sec = document.createElement('section');
          const h = document.createElement('div'); h.className = 'year-header'; h.textContent = y; sec.appendChild(h);
          const g = document.createElement('div'); g.className = 'releases-grid';
          grouped[y].forEach(r=>{
            if(type !== 'all' && r.type !== type) return;
            const card = document.createElement('div');
            card.className='release-card';
            card.setAttribute('role', 'button');
            card.setAttribute('tabindex', '0');
            card.innerHTML = `
              <img loading="lazy" src="../images/${r.cover}" alt="${r.title}">
              <div class="release-info">
                <div class="release-title">
                  ${r.title}
                  <span class="release-type-badge">${r.type}</span>
                </div>
                <div class="release-date">${formatDate(r.date)}</div>
                <div class="release-song-count">${r.songs} ${r.songs === 1 ? 'song' : 'songs'}</div>
                <div class="card-cta">View Details</div>
              </div>
            `;
            card.addEventListener('click', () => openModal(r));
            card.addEventListener('keydown', (e) => { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openModal(r); } });
            g.appendChild(card);
          });
          sec.appendChild(g); out.appendChild(sec);
        });
      }

      function populateFilters(){
        const years = [...new Set(releases.map(r=>r.date.slice(0,4)))].sort((a,b)=>b-a);
        const sel = document.getElementById('year-filter'); sel.innerHTML = '<option value="all">All</option>';
        years.forEach(y=>{ const o = document.createElement('option'); o.value = y; o.textContent = y; sel.appendChild(o); });
      }

      function getStreamingButtons(release) {
        const platforms = [
          { name: 'Spotify', icon: 'fab fa-spotify', key: 'spotify' },
          { name: 'Apple Music', icon: 'fab fa-apple', key: 'apple' },
          { name: 'YouTube Music', icon: 'fab fa-youtube', key: 'youtube' },
          { name: 'SoundCloud', icon: 'fab fa-soundcloud', key: 'soundcloud' }
        ];
        
        return platforms.map(p => {
          const url = release.streamingLinks?.[p.key] || release.link;
          return `<a href="${url}" target="_blank" rel="noopener noreferrer" class="streaming-btn" data-platform="${p.key}" title="${p.name}"><i class="${p.icon}"></i> ${p.name}</a>`;
        }).join('');
      }

      function openModal(release) {
        const modal = document.getElementById('release-modal');
        document.getElementById('modal-title').textContent = release.title;
        document.getElementById('modal-cover').src = `../images/${release.cover}`;
        document.getElementById('modal-cover').alt = release.title;
        document.querySelector('.modal-type').textContent = release.type;
        document.querySelector('.modal-date').textContent = `Released: ${formatDate(release.date)}`;
        document.getElementById('modal-streams').innerHTML = getStreamingButtons(release);
        document.getElementById('modal-main-link').href = release.link || '#';
        
        // Tracklist (only show if tracks are available and not a single)
        const tracklistDiv = document.getElementById('modal-tracklist');
        if(release.tracks && release.tracks.length > 0 && release.type !== 'Single') {
          tracklistDiv.style.display = 'block';
          tracklistDiv.innerHTML = `
            <h3>Track List</h3>
            <ol>
              ${release.tracks.map(t => `<li>${t}</li>`).join('')}
            </ol>
          `;
        } else {
          tracklistDiv.style.display = 'none';
          tracklistDiv.innerHTML = '';
        }
        
        modal.classList.add('active');
        modal.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
      }

      function closeModal() {
        const modal = document.getElementById('release-modal');
        modal.classList.remove('active');
        modal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
      }

      function setupModalHandlers() {
        const modal = document.getElementById('release-modal');
        const overlay = document.querySelector('.modal-overlay');
        const closeBtn = document.querySelector('.modal-close');
        
        closeBtn.addEventListener('click', closeModal);
        overlay.addEventListener('click', closeModal);
        
        document.addEventListener('keydown', (e) => {
          if(e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
          }
        });
      }

      function animateCounter(el, target, duration = 900){
        if(!el) return; const start = 0; const startTime = performance.now();
        function tick(now){ const t = Math.min((now - startTime) / duration, 1); el.textContent = Math.floor(start + (target - start) * t); if(t < 1) requestAnimationFrame(tick); else el.textContent = target; }
        requestAnimationFrame(tick);
      }

      document.addEventListener('DOMContentLoaded', ()=>{ 
        loadReleases();
        setupModalHandlers();
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const particleContainer = document.querySelector(".floating-particles");
        const layers = 3;
        const particleCount = 10;

        for (let layer = 0; layer < layers; layer++) {
          for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement("div");
            particle.classList.add("particle", `layer-${layer}`);

            const size = Math.random() * 12 + 6 * (1 + layer * 0.5);
            const top = Math.random() * 100;
            const left = Math.random() * 100;
            const duration = Math.random() * 4 + 10 * (1 + layer * 0.3);
            const opacity = Math.random() * 0.25 + 0.15 * (1 - layer * 0.25);

            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.top = `${top}%`;
            particle.style.left = `${left}%`;
            particle.style.animation = `float ${duration}s ease-in-out infinite alternate`;
            particle.style.opacity = opacity;

            particleContainer.appendChild(particle);
          }
        }
      });
    </script>
  </body>
</html>
